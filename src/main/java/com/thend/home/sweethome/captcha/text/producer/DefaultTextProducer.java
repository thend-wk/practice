package com.thend.home.sweethome.captcha.text.producer;

import java.security.SecureRandom;
import java.util.Random;

public class DefaultTextProducer
  implements TextProducer
{
  private static final Random _gen = new SecureRandom();
  public static final int EN_TEXT = 1;
  public static final int CN_TEXT = 2;
  private static final int DEFAULT_LENGTH = 5;
  private static final char[] DEFAULT_CHARS_EN = { 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'n', 'p', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', '2', '3', '4', '5', '6', '7', '8', 'A', 'C', 'D', 'E', 'F', 'H', 'K', 'J', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'Y' };

  private static final char[] DEFAULT_CHARS_CN = { 21834, 29233, 23433, 20843, 25226, 21543, 30333, 30334, 25308, 29677, 33324, 26495, 21322, 21150, 24110, 21253, 20445, 24339, 25265, 25253, 26479, 21271, 26631, 34920, 21035, 24182, 34917, 19981, 37096, 24067, 28779, 36135, 33719, 26426, 31215, 22522, 26497, 21450, 38598, 32423, 24613, 20132, 38128, 33050, 35282, 21483, 25945, 34987, 32972, 22791, 27492, 27425, 20174, 26449, 23384, 31572, 36798, 25171, 22823, 24102, 24453, 20195, 21333, 20294, 34507, 24403, 23548, 21040, 36947, 30340, 24471, 28783, 31561, 20302, 37329, 26408, 27700, 21271, 20013, 35789, 28779, 22303, 22320, 31532, 24351, 28857, 30005, 24215, 25481, 35843, 23450, 20908, 19996, 25026, 26020, 20165, 32039, 36817, 36827, 23613, 20140, 32463, 30555, 26223, 38745, 22659, 31350, 20061, 37202, 20037, 23601, 23621, 23616, 20030, 21477, 20855, 35273, 32477, 20915, 24320, 30475, 24247, 32771, 38752, 31185, 21487, 35838, 21051, 21160, 37117, 35835, 29420, 24230, 30701, 27573, 23545, 38431, 27493, 25165, 26448, 37319, 24425, 33609, 23618, 26366, 33590, 27941, 24191, 24030, 19996, 35199, 21335, 22810, 26421, 36530, 39295, 20799, 32780, 32819, 20108, 21457, 20047, 39277, 26041, 25151, 38450, 35775, 25918, 38750, 39134, 36153, 20998, 20221, 39118, 23553, 22827, 26381, 31119, 24220, 29238, 21103, 22797, 23500, 22919, 35813, 25913, 25954, 24863, 24178, 21018, 38050, 39640, 25630, 21578, 21733, 27468, 38761, 26684, 20010, 32473, 36319, 26681, 26356, 24037, 20844, 22815, 36141, 22993, 21476, 39592, 25925, 39038, 22266, 29916, 21038, 25346, 24618, 20851, 35266, 23448, 31649, 24815, 20809, 24191, 35268, 36149, 26524, 36807, 36824, 28023, 21547, 27735, 22909, 21495, 27827, 21644, 20309, 21512, 24456, 32418, 21518, 20505, 21628, 24573, 20046, 28246, 32993, 34382, 25143, 20114, 25252, 33457, 21326, 21010, 30011, 21270, 35805, 24576, 27426, 29615, 25442, 40644, 22238, 20250, 27963, 38065, 24039, 20999, 19988, 20146, 36731, 38738, 28165, 24773, 35831, 24198, 31351, 31179, 27714, 29699, 21306, 21462, 21435, 36259, 20840, 32570, 21364, 23637, 25112, 24352, 19976, 31456, 25307, 25214, 32773, 36825, 30495, 27491, 25972, 35777, 20043, 25903, 30452, 20540, 21482, 27490, 33267, 38047, 20247, 27954, 24030, 31481, 20027, 20303, 31069, 23376, 20180, 23383, 26368, 26152, 24038, 20316, 20570, 22352, 24231, 24847, 20041, 33402, 26131, 35758, 22240, 38899, 24212, 33521, 26144, 29992, 20248, 30001, 27833, 26377, 21451, 21448, 21491, 40060 };
  private final int _length;
  private final char[] _srcChars;

  public DefaultTextProducer()
  {
    this(5, 1);
  }

  public DefaultTextProducer(int length, int type) {
    this._length = length;
    if (type == 1)
      this._srcChars = DEFAULT_CHARS_EN;
    else if (type == 2)
      this._srcChars = DEFAULT_CHARS_CN;
    else
      this._srcChars = DEFAULT_CHARS_EN;
  }

  public String getText()
  {
    int car = this._srcChars.length - 1;

    String capText = "";
    for (int i = 0; i < this._length; ++i) {
      capText = capText + this._srcChars[(_gen.nextInt(car) + 1)];
    }

    return capText;
  }
}